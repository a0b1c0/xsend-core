---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { languages, ui, defaultLang } from '../../i18n/ui';
import { getEntry } from 'astro:content';

export async function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({ params: { lang } }));
}

const { lang } = Astro.params;
const t = ui[lang as keyof typeof ui] || ui[defaultLang];

// Fetch FAQ data for this language, fallback to English if missing
let faqEntry = await getEntry('faq', lang);
if (!faqEntry) {
  faqEntry = await getEntry('faq', 'en');
}
const faqs = faqEntry?.data.questions || [];
---

<BaseLayout title={`FAQ - xSend`} lang={lang}>
  <Header lang={lang} />
  
  <main class="py-16 bg-white dark:bg-slate-950 min-h-screen">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-16">
        <h1 class="text-4xl font-extrabold text-slate-900 dark:text-white mb-4">
          {t['nav.faq']}
        </h1>
        <p class="text-lg text-slate-600 dark:text-slate-400">
          Frequently asked questions about security, features, and troubleshooting.
        </p>
      </div>

      <div class="space-y-8">
        {faqs.map((item) => (
          <div class="border-b border-slate-200 dark:border-slate-800 pb-8 last:border-0">
            <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-3">
              {item.q}
            </h3>
            <div class="prose prose-slate dark:prose-invert text-slate-600 dark:text-slate-300">
              <p>{item.a}</p>
            </div>
          </div>
        ))}
      </div>
      
      {faqs.length === 0 && (
         <div class="text-center text-slate-500">
            No FAQ items found.
         </div>
      )}
    </div>
  </main>
  <Footer lang={lang} />
</BaseLayout>
